% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/resolve_bootstrap_method.R
\name{resolve_bootstrap_method}
\alias{resolve_bootstrap_method}
\title{Resolve bootstrap method including use of the boot package}
\usage{
resolve_bootstrap_method(df, fun, ..., cat_var, ref_group, method)
}
\arguments{
\item{df}{A dataframe.}

\item{fun}{A function which, when applied to \code{df}, returns the
statistic(s) of interest. This function must return a dataframe with a
column \code{diversity_val}.}

\item{...}{Additional arguments passed to \code{fun}.}

\item{cat_var}{A character vector specifying the grouping variable(s)
used by \code{fun}.}

\item{ref_group}{A value indicating the reference group. If \code{NA},
bootstrapping may be delegated to the \pkg{boot} package.}

\item{method}{Character string specifying the bootstrap method.
One of \code{"whole_cube"}, \code{"group_specific"}, \code{"boot_whole_cube"},
\code{"boot_group_specific"}, or \code{"smart"}.}
}
\value{
A single character string giving the resolved bootstrap method:
\itemize{
\item \code{"whole_cube"}
\item \code{"group_specific"}
\item \code{"boot_whole_cube"}
\item \code{"boot_group_specific"}
}
}
\description{
Resolves the effective bootstrap method to be used by
\code{\link[=bootstrap_cube]{bootstrap_cube()}}, combining:
}
\details{
\itemize{
\item the scope of the indicator (group-specific vs whole-cube), and
\item whether a reference group is used.
}

When \code{method = "smart"}, the scope of the indicator is inferred using
\code{\link[=derive_bootstrap_method]{derive_bootstrap_method()}}. If no reference group is specified
(\code{ref_group = NA}) and exactly one grouping variable is used
(\code{length(cat_var) == 1}), the corresponding \verb{boot_*} method is selected.

The resolution follows these rules:
\enumerate{
\item If \code{method} is not \code{"smart"}, it is returned unchanged.
\item If \code{method = "smart"}, the indicator scope is inferred using
\code{\link[=derive_bootstrap_method]{derive_bootstrap_method()}}.
\item If more than one grouping variable is specified
(\code{length(cat_var) > 1}), bootstrapping via the \pkg{boot} package
is disabled and the inferred non-boot method is returned.
\item If exactly one grouping variable is used and \code{ref_group = NA},
the resolved method is prefixed with \code{"boot_"}, resulting in
\code{"boot_group_specific"} or \code{"boot_whole_cube"}.
\item If a reference group is specified, the non-boot variants
\code{"group_specific"} or \code{"whole_cube"} are returned.
}
}
\examples{
# Example 1: Group-specific indicator without a reference group
# Mean sepal length per species (calculated independently per group)
mean_sepal_length <- function(x) {
  out_df <- aggregate(Sepal.Length ~ Species, x, mean)
  names(out_df) <- c("Species", "diversity_val")
  out_df
}

resolve_bootstrap_method(
  df = iris,
  fun = mean_sepal_length,
  cat_var = "Species",
  ref_group = NA,
  method = "smart"
)

# Example 2: Group-specific indicator with a reference group
resolve_bootstrap_method(
  df = iris,
  fun = mean_sepal_length,
  cat_var = "Species",
  ref_group = "setosa",
  method = "smart"
)

# Example 3: Indicator that depends on the whole cube
# The statistic per species depends on all species together
scaled_sepal_length <- function(x) {
  out_df <- aggregate(Sepal.Length ~ Species, x, mean)
  out_df$Sepal.Length <- out_df$Sepal.Length / nrow(out_df)
  names(out_df) <- c("Species", "diversity_val")
  out_df
}

resolve_bootstrap_method(
  df = iris,
  fun = scaled_sepal_length,
  cat_var = "Species",
  ref_group = NA,
  method = "smart"
)
}
\seealso{
Other indicator_uncertainty_helper: 
\code{\link{boot_list_to_dataframe}()},
\code{\link{bootstrap_cube_raw}()},
\code{\link{calculate_boot_ci_from_boot}()},
\code{\link{derive_bootstrap_method}()}
}
\concept{indicator_uncertainty_helper}
