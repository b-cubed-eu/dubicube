<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate confidence intervals for a dataframe with bootstrap replicates — calculate_bootstrap_ci • dubicube</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/PT_Sans-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Calculate confidence intervals for a dataframe with bootstrap replicates — calculate_bootstrap_ci"><meta name="description" content="This function calculates confidence intervals for a dataframe containing
bootstrap replicates based on different methods, including percentile
(perc), bias-corrected and accelerated (bca), normal (norm), and basic
(basic)."><meta property="og:description" content="This function calculates confidence intervals for a dataframe containing
bootstrap replicates based on different methods, including percentile
(perc), bias-corrected and accelerated (bca), normal (norm), and basic
(basic)."><meta property="og:image" content="https://b-cubed-eu.github.io/dubicube/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dubicube</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/index.html">Tutorials</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="nav-item"><a class="nav-link" href="../CONTRIBUTING.html">Contributing</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://b-cubed.eu/" aria-label="B-Cubed website"><span class="fa fa-cube"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/b-cubed-eu/dubicube/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate confidence intervals for a dataframe with bootstrap replicates</h1>
      <small class="dont-index">Source: <a href="https://github.com/b-cubed-eu/dubicube/blob/main/R/calculate_bootstrap_ci.R" class="external-link"><code>R/calculate_bootstrap_ci.R</code></a></small>
      <div class="d-none name"><code>calculate_bootstrap_ci.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function calculates confidence intervals for a dataframe containing
bootstrap replicates based on different methods, including percentile
(<code>perc</code>), bias-corrected and accelerated (<code>bca</code>), normal (<code>norm</code>), and basic
(<code>basic</code>).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calculate_bootstrap_ci</span><span class="op">(</span></span>
<span>  <span class="va">bootstrap_samples_df</span>,</span>
<span>  <span class="va">grouping_var</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"perc"</span>, <span class="st">"bca"</span>, <span class="st">"norm"</span>, <span class="st">"basic"</span><span class="op">)</span>,</span>
<span>  conf <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  h <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="va">t</span>,</span>
<span>  hinv <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="va">t</span>,</span>
<span>  no_bias <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  aggregate <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  data_cube <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  fun <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  ref_group <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  influence_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">is.element</a></span><span class="op">(</span><span class="st">"bca"</span>, <span class="va">type</span><span class="op">)</span>, <span class="st">"usual"</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  progress <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-bootstrap-samples-df">bootstrap_samples_df<a class="anchor" aria-label="anchor" href="#arg-bootstrap-samples-df"></a></dt>
<dd><p>A dataframe containing the bootstrap replicates,
where each row represents a bootstrap sample. As returned by
<code><a href="bootstrap_cube.html">bootstrap_cube()</a></code>. Apart from the <code>grouping_var</code> column, the following
columns should be present:</p><ul><li><p><code>est_original</code>: The statistic based on the full dataset per group</p></li>
<li><p><code>rep_boot</code>: The statistic based on a bootstrapped dataset (bootstrap
replicate)</p></li>
</ul></dd>


<dt id="arg-grouping-var">grouping_var<a class="anchor" aria-label="anchor" href="#arg-grouping-var"></a></dt>
<dd><p>A character vector specifying the grouping variable(s)
for the bootstrap analysis. The function <code>fun(data_cube$data, ...)</code> should
return a row per group. The specified variables must not be redundant,
meaning they should not contain the same information (e.g., <code>"time_point"</code>
(1, 2, 3) and <code>"year"</code> (2000, 2001, 2002) should not be used together if
<code>"time_point"</code> is just an alternative encoding of <code>"year"</code>).
This variable is used to split the dataset into groups for separate
confidence interval calculations.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>A character vector specifying the type(s) of confidence intervals
to compute. Options include:</p><ul><li><p><code>"perc"</code>: Percentile interval</p></li>
<li><p><code>"bca"</code>: Bias-corrected and accelerated interval</p></li>
<li><p><code>"norm"</code>: Normal interval</p></li>
<li><p><code>"basic"</code>: Basic interval</p></li>
<li><p><code>"all"</code>: Compute all available interval types (default)</p></li>
</ul></dd>


<dt id="arg-conf">conf<a class="anchor" aria-label="anchor" href="#arg-conf"></a></dt>
<dd><p>A numeric value specifying the confidence level of the intervals.
Default is <code>0.95</code> (95 % confidence level).</p></dd>


<dt id="arg-h">h<a class="anchor" aria-label="anchor" href="#arg-h"></a></dt>
<dd><p>A function defining a transformation. The intervals are calculated
on the scale of <code>h(t)</code> and the inverse function <code>hinv</code> applied to the
resulting intervals. It must be a function of one variable only. The default
is the identity function.</p></dd>


<dt id="arg-hinv">hinv<a class="anchor" aria-label="anchor" href="#arg-hinv"></a></dt>
<dd><p>A function, like <code>h</code>, which returns the inverse of <code>h</code>. It is
used to transform the intervals calculated on the scale of <code>h(t)</code> back to the
original scale. The default is the identity function. If <code>h</code> is supplied but
<code>hinv</code> is not, then the intervals returned will be on the transformed scale.</p></dd>


<dt id="arg-no-bias">no_bias<a class="anchor" aria-label="anchor" href="#arg-no-bias"></a></dt>
<dd><p>Logical. If <code>TRUE</code> intervals are centered around the original
estimates (bias is ignored). Default is <code>FALSE</code>.</p></dd>


<dt id="arg-aggregate">aggregate<a class="anchor" aria-label="anchor" href="#arg-aggregate"></a></dt>
<dd><p>Logical. If <code>TRUE</code> (default), the function returns distinct
confidence limits per group. If <code>FALSE</code>, the confidence limits are added to
the original bootstrap dataframe <code>bootstrap_samples_df</code>.</p></dd>


<dt id="arg-data-cube">data_cube<a class="anchor" aria-label="anchor" href="#arg-data-cube"></a></dt>
<dd><p>Only used when <code>type = "bca"</code>. A data cube object (class
'processed_cube' or 'sim_cube', see <code><a href="https://b-cubed-eu.github.io/b3gbi/reference/process_cube.html" class="external-link">b3gbi::process_cube()</a></code>) or a dataframe
(cf. <code>$data</code> slot of 'processed_cube' or 'sim_cube'). As used by
<code><a href="bootstrap_cube.html">bootstrap_cube()</a></code>.</p></dd>


<dt id="arg-fun">fun<a class="anchor" aria-label="anchor" href="#arg-fun"></a></dt>
<dd><p>Only used when <code>type = "bca"</code>.
A function which, when applied to <code>data_cube$data</code> returns the
statistic(s) of interest (or just <code>data_cube</code> in case of a dataframe).
This function must return a dataframe with a column <code>diversity_val</code>
containing the statistic of interest.
As used by <code><a href="bootstrap_cube.html">bootstrap_cube()</a></code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed on to <code>fun</code>.</p></dd>


<dt id="arg-ref-group">ref_group<a class="anchor" aria-label="anchor" href="#arg-ref-group"></a></dt>
<dd><p>Only used when <code>type = "bca"</code>. A string indicating the
reference group to compare the statistic with. Default is <code>NA</code>, meaning no
reference group is used.
As used by <code><a href="bootstrap_cube.html">bootstrap_cube()</a></code>.</p></dd>


<dt id="arg-influence-method">influence_method<a class="anchor" aria-label="anchor" href="#arg-influence-method"></a></dt>
<dd><p>A string specifying the method used for calculating
the influence values.</p><ul><li><p><code>"usual"</code>: Negative jackknife (default if BCa is selected).</p></li>
<li><p><code>"pos"</code>: Positive jackknife</p></li>
</ul></dd>


<dt id="arg-progress">progress<a class="anchor" aria-label="anchor" href="#arg-progress"></a></dt>
<dd><p>Logical. Whether to show a progress bar for jackknifing. Set
to <code>TRUE</code> to display a progress bar, <code>FALSE</code> (default) to suppress it.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A dataframe containing the bootstrap results with the following
columns:</p><ul><li><p><code>est_original</code>: The statistic based on the full dataset per group</p></li>
<li><p>rep_boo</p></li>
<li><p><code>est_boot</code>: The bootstrap estimate (mean of bootstrap replicates per
group)</p></li>
<li><p><code>se_boot</code>: The standard error of the bootstrap estimate (standard
deviation of the bootstrap replicates per group)</p></li>
<li><p><code>bias_boot</code>: The bias of the bootstrap estimate per group</p></li>
<li><p><code>int_type</code>: The interval type</p></li>
<li><p><code>ll</code>: The lower limit of the confidence interval</p></li>
<li><p><code>ul</code>: The upper limit of the confidence interval</p></li>
<li><p><code>conf</code>: The confidence level of the interval
When <code>aggregate = FALSE</code>, the dataframe contains the columns from
<code>bootstrap_samples_df</code> with one row per bootstrap replicate.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>We consider four different types of intervals (with confidence level
\(\alpha\)). The choice for confidence interval types and their calculation
is in line with the <span class="pkg">boot</span> package in R (Canty &amp; Ripley, 1999) to ensure
ease of implementation. They are based on the definitions provided by
Davison &amp; Hinkley (1997, Chapter 5)
(see also DiCiccio &amp; Efron, 1996; Efron, 1987).</p><ol><li><p><strong>Percentile</strong>: Uses the percentiles of the bootstrap distribution.</p>
<p>$$CI_{perc} = \left[ \hat{\theta}^*_{(\alpha/2)}, \hat{\theta}^*_{(1-\alpha/2)} \right]$$</p>
<p>where \(\hat{\theta}^*_{(\alpha/2)}\) and
\(\hat{\theta}^*_{(1-\alpha/2)}\) are the \(\alpha/2\) and
\(1-\alpha/2\) percentiles of the bootstrap distribution, respectively.</p></li>
<li><p><strong>Bias-Corrected and Accelerated (BCa)</strong>: Adjusts for bias and
acceleration</p>
<p>Bias refers to the systematic difference between the observed statistic
from the original dataset and the center of the bootstrap distribution of
the statistic. The bias correction term is calculated as follows:</p>
<p>$$\hat{z}_0 = \Phi^{-1}\left(\frac{\#(\hat{\theta}^*_b &lt; \hat{\theta})}{B}\right)$$</p>
<p>where \(\#\) is the counting operator, counting the number of times
\(\hat{\theta}^*_b\) is smaller than \(\hat{\theta}\), and
\(\Phi^{-1}\) the inverse cumulative density function of the standard
normal distribution.\(B\) is the number of bootstrap samples.</p>
<p>Acceleration quantifies how sensitive the variability of the statistic is
to changes in the data.
See <code><a href="calculate_acceleration.html">calculate_acceleration()</a></code> on how this is calculated.</p><ul><li><p>\(a=0\): The statistic's variability does not depend on the data
(e.g., symmetric distribution)</p></li>
<li><p>\(a&gt;0\): Small changes in the data have a large effect on the
statistic's variability (e.g., positive skew)</p></li>
<li><p>\(a&lt;0\): Small changes in the data have a smaller effect on the
statistic's variability (e.g., negative skew).</p></li>
</ul><p>The bias and acceleration estimates are then used to calculate adjusted
percentiles.</p>
<p>\(\alpha_1 = \Phi\left( \hat{z}_0 + \frac{\hat{z}_0 + z_{\alpha/2}}{1 - \hat{a}(\hat{z}_0 + z_{\alpha/2})} \right)\),
\(\alpha_2 = \Phi\left( \hat{z}_0 + \frac{\hat{z}_0 + z_{1 - \alpha/2}}{1 - \hat{a}(\hat{z}_0 + z_{1 - \alpha/2})} \right)\)</p>
<p>So, we get</p>
<p>$$CI_{bca} = \left[ \hat{\theta}^*_{(\alpha_1)}, \hat{\theta}^*_{(\alpha_2)} \right]$$</p></li>
<li><p><strong>Normal</strong>: Assumes the bootstrap distribution of the statistic is
approximately normal</p>
<p>$$CI_{norm} = \left[\hat{\theta} - \text{Bias}_{\text{boot}} - \text{SE}_{\text{boot}} \times z_{1-\alpha/2},
   \hat{\theta} - \text{Bias}_{\text{boot}} + \text{SE}_{\text{boot}} \times z_{1-\alpha/2} \right]$$</p>
<p>where \(z_{1-\alpha/2}\) is the \(1-\alpha/2\) quantile of the
standard normal distribution.</p></li>
<li><p><strong>Basic</strong>: Centers the interval using percentiles</p>
<p>$$CI_{basic} = \left[ 2\hat{\theta} - \hat{\theta}^*_{(1-\alpha/2)},
   2\hat{\theta} - \hat{\theta}^*_{(\alpha/2)} \right]$$</p>
<p>where \(\hat{\theta}^*_{(\alpha/2)}\) and
\(\hat{\theta}^*_{(1-\alpha/2)}\) are the \(\alpha/2\) and
\(1-\alpha/2\) percentiles of the bootstrap distribution, respectively.</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Canty, A., &amp; Ripley, B. (1999). boot: Bootstrap Functions (Originally by
Angelo Canty for S) [Computer software].
<a href="https://CRAN.R-project.org/package=boot" class="external-link">https://CRAN.R-project.org/package=boot</a></p>
<p>Davison, A. C., &amp; Hinkley, D. V. (1997). Bootstrap Methods and their
Application (1st ed.). Cambridge University Press.
<a href="https://doi.org/10.1017/CBO9780511802843" class="external-link">doi:10.1017/CBO9780511802843</a></p>
<p>DiCiccio, T. J., &amp; Efron, B. (1996). Bootstrap confidence intervals.
Statistical Science, 11(3). <a href="https://doi.org/10.1214/ss/1032280214" class="external-link">doi:10.1214/ss/1032280214</a></p>
<p>Efron, B. (1987). Better Bootstrap Confidence Intervals. Journal of the
American Statistical Association, 82(397), 171–185.
<a href="https://doi.org/10.1080/01621459.1987.10478410" class="external-link">doi:10.1080/01621459.1987.10478410</a></p>
<p>Efron, B., &amp; Tibshirani, R. J. (1994). An Introduction to the Bootstrap
(1st ed.). Chapman and Hall/CRC. <a href="https://doi.org/10.1201/9780429246593" class="external-link">doi:10.1201/9780429246593</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other indicator_uncertainty:
<code><a href="add_effect_classification.html">add_effect_classification</a>()</code>,
<code><a href="bootstrap_cube.html">bootstrap_cube</a>()</code>,
<code><a href="calculate_acceleration.html">calculate_acceleration</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># After processing a data cube with b3gbi::process_cube()</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Function to calculate statistic of interest</span></span></span>
<span class="r-in"><span><span class="co"># Mean observations per year</span></span></span>
<span class="r-in"><span><span class="va">mean_obs</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">out_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">obs</span> <span class="op">~</span> <span class="va">year</span>, <span class="va">data</span>, <span class="va">mean</span><span class="op">)</span> <span class="co"># Calculate mean obs per year</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">out_df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"year"</span>, <span class="st">"diversity_val"</span><span class="op">)</span> <span class="co"># Rename columns</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out_df</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu">mean_obs</span><span class="op">(</span><span class="va">processed_cube</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Perform bootstrapping</span></span></span>
<span class="r-in"><span><span class="va">bootstrap_mean_obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="bootstrap_cube.html">bootstrap_cube</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  data_cube <span class="op">=</span> <span class="va">processed_cube</span>,</span></span>
<span class="r-in"><span>  fun <span class="op">=</span> <span class="va">mean_obs</span>,</span></span>
<span class="r-in"><span>  grouping_var <span class="op">=</span> <span class="st">"year"</span>,</span></span>
<span class="r-in"><span>  samples <span class="op">=</span> <span class="fl">1000</span>,</span></span>
<span class="r-in"><span>  seed <span class="op">=</span> <span class="fl">123</span>,</span></span>
<span class="r-in"><span>  progress <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">bootstrap_mean_obs</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate confidence limits</span></span></span>
<span class="r-in"><span><span class="co"># Percentile interval</span></span></span>
<span class="r-in"><span><span class="va">ci_mean_obs1</span> <span class="op">&lt;-</span> <span class="fu">calculate_bootstrap_ci</span><span class="op">(</span></span></span>
<span class="r-in"><span>  bootstrap_samples_df <span class="op">=</span> <span class="va">bootstrap_mean_obs</span>,</span></span>
<span class="r-in"><span>  grouping_var <span class="op">=</span> <span class="st">"year"</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"perc"</span>,</span></span>
<span class="r-in"><span>  conf <span class="op">=</span> <span class="fl">0.95</span>,</span></span>
<span class="r-in"><span>  aggregate <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ci_mean_obs1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># All intervals</span></span></span>
<span class="r-in"><span><span class="va">ci_mean_obs2</span> <span class="op">&lt;-</span> <span class="fu">calculate_bootstrap_ci</span><span class="op">(</span></span></span>
<span class="r-in"><span>  bootstrap_samples_df <span class="op">=</span> <span class="va">bootstrap_mean_obs</span>,</span></span>
<span class="r-in"><span>  grouping_var <span class="op">=</span> <span class="st">"year"</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"perc"</span>, <span class="st">"bca"</span>, <span class="st">"norm"</span>, <span class="st">"basic"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  conf <span class="op">=</span> <span class="fl">0.95</span>,</span></span>
<span class="r-in"><span>  aggregate <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  data_cube <span class="op">=</span> <span class="va">processed_cube</span>, <span class="co"># Required for BCa</span></span></span>
<span class="r-in"><span>  fun <span class="op">=</span> <span class="va">mean_obs</span>,             <span class="co"># Required for BCa</span></span></span>
<span class="r-in"><span>  progress <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ci_mean_obs2</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ward Langeraert, Toon Van Daele, European Union.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

